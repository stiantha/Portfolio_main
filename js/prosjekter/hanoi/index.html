<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      body {
        display: flex;
        background-color: #2c2c2c;
        color: #f5f5f5;
        justify-content: center;
        height: 100vh;
        align-items: center;
      }
      .game-container {
        display: flex;
        justify-content: space-between;
        margin: 0 auto;
        max-width: 600px;
      }

      .tower-container {
        position: relative;
        margin-bottom: 2rem;
      }

      .tower {
        width: 150px;
        height: 120px;
        display: flex;
        flex-direction: column-reverse;
        align-items: center;
        border-bottom: 8px solid rgb(255, 255, 255);
      }

      .tower-container::before {
        content: "";
        position: absolute;
        bottom: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 8px;
        height: 150px;
        z-index: -10;
        background-color: rgb(255, 255, 255);
      }

      .disk {
        height: 20px;
        background-color: rgb(255, 153, 0);
        border: 4px solid rgb(59, 59, 59);
        margin-bottom: 5px;
      }

      .btn-container {
        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: center;
        margin: 1rem;
      }
      .btn {
        color: rgb(0, 0, 0);
        display: block;
        background-color: green;
        margin: 1rem;
        width: 10rem;
        height: 2rem;
        cursor: pointer;
        pointer-events: auto;
      }

      .invalid-button {
        background-color: gray;
        cursor: not-allowed;
        pointer-events: none;
      }

      span {
        display: flex;
        position: absolute;
        justify-content: center;
        margin-top: -4rem;
      }
    </style>
  </head>

  <body>
    <div id="app"></div>
  </body>
  <script>
    let smallDiskTowerIndex = 0;
    let mediumDiskTowerIndex = 0;
    let largeDiskTowerIndex = 0;
    let appElement = document.getElementById("app");
    let towerLeft, towerMiddle, towerRight;

    const smallDisk = createDisk(30);
    const mediumDisk = createDisk(70);
    const largeDisk = createDisk(100);

    function createDisk(width) {
      const disk = document.createElement("div");
      disk.className = "disk";
      disk.style.width = `${width}px`;
      return disk;
    }

    // view

    updateView();
    function updateView() {
      appElement.innerHTML = /*HTML*/ `
        <div class="game-container">
          <div class="tower-container">
            <div class="tower" id="leftTower">
              ${generateDiskElements(
                largeDiskTowerIndex,
                mediumDiskTowerIndex,
                smallDiskTowerIndex,
                0
              )}
            </div>
          </div>
          <div class="tower-container">
            <div class="tower" id="middleTower">
              ${generateDiskElements(
                largeDiskTowerIndex,
                mediumDiskTowerIndex,
                smallDiskTowerIndex,
                1
              )}
            </div>
          </div>
          <div class="tower-container">
            <div class="tower" id="rightTower">
              ${generateDiskElements(
                largeDiskTowerIndex,
                mediumDiskTowerIndex,
                smallDiskTowerIndex,
                2
              )}
            </div>
          </div>
        </div>
        
        <div class="btn-container">
       <span>Liten Disk</span> 
        <button class="btn" data-size="small" data-tower="0" onclick="moveDisk('small', 0)">VENSTRE</button>
        <button class="btn" data-size="small" data-tower="1" onclick="moveDisk('small', 1)">MIDTRE</button>
        <button class="btn" data-size="small" data-tower="2" onclick="moveDisk('small', 2)">HØYRE</button>
        </div>
    
        <div class="btn-container">
            <span>Medium Disk</span> 
        <button class="btn" data-size="medium" data-tower="0" onclick="moveDisk('medium', 0)">VENSTRE</button>
        <button class="btn" data-size="medium" data-tower="1" onclick="moveDisk('medium', 1)">MIDTRE</button>
        <button class="btn" data-size="medium" data-tower="2" onclick="moveDisk('medium', 2)">HØYRE</button>
        </div>
        <div class="btn-container">
            <span>Stor Disk</span> 
        <button class="btn" data-size="large" data-tower="0" onclick="moveDisk('large', 0)">VENSTRE</button>
        <button class="btn" data-size="large" data-tower="1" onclick="moveDisk('large', 1)">MIDTRE</button>
        <button class="btn" data-size="large" data-tower="2" onclick="moveDisk('large', 2)">HØYRE</button>
        </div>
    `;

      towerLeft = appElement.querySelector("#leftTower");
      towerMiddle = appElement.querySelector("#middleTower");
      towerRight = appElement.querySelector("#rightTower");
    }

    function generateDiskElements(
      largeDiskIndex,
      mediumDiskIndex,
      smallDiskIndex,
      towerIndex
    ) {
      let disks = "";
      if (towerIndex === largeDiskIndex) {
        disks += createDiskElement(100);
      }
      if (towerIndex === mediumDiskIndex) {
        disks += createDiskElement(70);
      }
      if (towerIndex === smallDiskIndex) {
        disks += createDiskElement(40);
      }
      return disks;
    }

    function createDiskElement(width) {
      return `<div class="disk" style="width: ${width}px;"></div>`;
    }

    // controller

    function canMoveDisk(fromSize, fromTowerIndex, toTowerIndex) {
      if (
        (fromSize === "small" &&
          (toTowerIndex === largeDiskTowerIndex ||
            toTowerIndex === mediumDiskTowerIndex)) ||
        (fromSize === "medium" && toTowerIndex === largeDiskTowerIndex)
      ) {
        return false;
      }

      if (
        fromSize === "small" &&
        (toTowerIndex === mediumDiskTowerIndex ||
          toTowerIndex === largeDiskTowerIndex)
      ) {
        return true;
      }

      if (fromSize === "medium" && toTowerIndex === largeDiskTowerIndex) {
        return true;
      }

      return true;
    }

    function updateButtonVisibility() {
      const buttons = document.querySelectorAll("button");

      buttons.forEach((button) => {
        const size = button.getAttribute("data-size");
        const towerIndex = Number(button.getAttribute("data-tower"));

        if (canMoveDisk(size, towerIndex, towerIndex)) {
          button.style.display = "block";
          button.classList.remove("invalid-button"); // Remove invalid style
        } else {
          button.style.display = "block";
          button.classList.add("invalid-button"); // Add invalid style
        }
      });
    }

    function moveDisk(size, toTowerIndex) {
      if (
        size === "small" &&
        !canMoveDisk(size, smallDiskTowerIndex, toTowerIndex)
      ) {
        return;
      }
      if (
        size === "medium" &&
        !canMoveDisk(size, mediumDiskTowerIndex, toTowerIndex)
      ) {
        return;
      }

      let disk;
      if (size === "small") {
        disk = createDisk(40);
        smallDiskTowerIndex = toTowerIndex;
      } else if (size === "medium") {
        disk = createDisk(70);
        mediumDiskTowerIndex = toTowerIndex;
      } else if (size === "large") {
        disk = createDisk(100);
        largeDiskTowerIndex = toTowerIndex;
      }

      if (toTowerIndex === 0) {
        towerLeft.appendChild(disk);
      } else if (toTowerIndex === 1) {
        towerMiddle.appendChild(disk);
      } else if (toTowerIndex === 2) {
        towerRight.appendChild(disk);
      }

      updateView();
      updateButtonVisibility();
    }
  </script>
</html>
